# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - –¢–µ—Å—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Excel —Ñ–∞–π–ª–∞

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install pandas==2.0.3 openpyxl==3.1.2
```

## 2. –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞

```bash
python test_excel_download_example.py
```

## 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ pytest

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Excel
pytest tests/test_contacts.py::TestContacts::test_download_and_open_excel_file -v -s

# –ó–∞–ø—É—Å–∫ —Å –≤—ã–≤–æ–¥–æ–º –≤ –∫–æ–Ω—Å–æ–ª—å
pytest tests/test_contacts.py::TestContacts::test_download_and_open_excel_file -v -s --tb=short
```

## 4. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç

1. üîê –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ
2. üìÑ –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤  
3. ‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–µ—Ç Excel —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É `EXPORT_EXCEL_BUTTON`
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª —Å–∫–∞—á–∞–ª—Å—è –∏ –Ω–µ –ø—É—Å—Ç–æ–π
5. üìä –ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ Excel —Ñ–∞–π–ª–∞
6. üîç –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
7. üñ•Ô∏è –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –≤ —Å–∏—Å—Ç–µ–º–µ

## 5. –†–µ–∑—É–ª—å—Ç–∞—Ç

- –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É `downloads/`
- –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ
- Excel —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

## 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –æ–∂–∏–¥–∞–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤ —Ç–µ—Å—Ç–µ:

```python
expected_columns = ['–ò–º—è', '–õ–æ–≥–∏–Ω', '–¢–µ–ª–µ—Ñ–æ–Ω', '–ö–∞–Ω–∞–ª']  # –í–∞—à–∏ –∫–æ–ª–æ–Ω–∫–∏
```
